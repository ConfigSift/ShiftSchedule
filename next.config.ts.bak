import type { NextConfig } from "next";

const noIndexPrefixes = [
  "dashboard",
  "restaurants",
  "manager",
  "schedule",
  "reports",
  "staff",
  "chat",
  "billing",
  "subscribe",
  "review-requests",
  "time-off",
  "blocked-days",
  "business-hours",
  "profile",
  "account",
  "persona",
  "reset-passcode",
  "setup",
  "onboarding",
];

const nextConfig: NextConfig = {
  typescript: {
    ignoreBuildErrors: true,
  },
  eslint: {
    ignoreDuringBuilds: true,
  },
  compiler: {
    removeConsole: {
      exclude: ['error'],
    },
  },
  allowedDevOrigins: [
    "http://192.168.1.4:3000",
    "http://169.254.5.254:3000",
    "http://localhost:3000",
  ],
  async redirects() {
    return [
      {
        source: "/:path*",
        has: [{ type: "host", value: "www.crewshyft.com" }],
        destination: "https://crewshyft.com/:path*",
        permanent: true,
      },
    ];
  },
  async rewrites() {
    return [
      {
        source: "/",
        has: [{ type: "host", value: "app.crewshyft.com" }],
        destination: "/dashboard",
      },
      {
        source: "/schedule",
        has: [{ type: "host", value: "app.crewshyft.com" }],
        destination: "/dashboard",
      },
    ];
  },
  async headers() {
    return noIndexPrefixes.flatMap((prefix) => [
      {
        source: `/${prefix}`,
        headers: [
          {
            key: "X-Robots-Tag",
            value: "noindex, nofollow",
          },
        ],
      },
      {
        source: `/${prefix}/:path*`,
        headers: [
          {
            key: "X-Robots-Tag",
            value: "noindex, nofollow",
          },
        ],
      },
    ]);
  },
};

export default nextConfig;
